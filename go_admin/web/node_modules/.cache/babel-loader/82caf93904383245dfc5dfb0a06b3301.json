{"remainingRequest":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_babel-loader@8.2.2@babel-loader\\lib\\index.js!E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_eslint-loader@2.2.1@eslint-loader\\index.js??ref--13-0!E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\src\\utils\\request.js","dependencies":[{"path":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\src\\utils\\request.js","mtime":1618795335776},{"path":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_babel-loader@8.2.2@babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_eslint-loader@2.2.1@eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9NZXNzYWdlMiBmcm9tICJlbGVtZW50LXVpL2xpYi90aGVtZS1jaGFsay9tZXNzYWdlLmNzcyI7CmltcG9ydCAiZWxlbWVudC11aS9saWIvdGhlbWUtY2hhbGsvYmFzZS5jc3MiOwppbXBvcnQgX01lc3NhZ2UgZnJvbSAiZWxlbWVudC11aS9saWIvbWVzc2FnZSI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7IC8vIOW8leWFpWF4aW9zCgppbXBvcnQgeyBzdG9yZSB9IGZyb20gJ0Avc3RvcmUvaW5kZXgnOwppbXBvcnQgY29udGV4dCBmcm9tICdAL21haW4uanMnOwppbXBvcnQgcm91dGVyIGZyb20gJ0Avcm91dGVyL2luZGV4JzsKdmFyIHNlcnZpY2UgPSBheGlvcy5jcmVhdGUoewogIGJhc2VVUkw6IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9BUEksCiAgdGltZW91dDogOTk5OTkKfSk7CnZhciBhY2l0dmVBeGlvcyA9IDA7CnZhciB0aW1lcjsKCnZhciBzaG93TG9hZGluZyA9IGZ1bmN0aW9uIHNob3dMb2FkaW5nKCkgewogIGFjaXR2ZUF4aW9zKys7CgogIGlmICh0aW1lcikgewogICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsKICB9CgogIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICBpZiAoYWNpdHZlQXhpb3MgPiAwKSB7CiAgICAgIGNvbnRleHQuJGJ1cy5lbWl0KCJzaG93TG9hZGluZyIpOwogICAgfQogIH0sIDQwMCk7Cn07Cgp2YXIgY2xvc2VMb2FkaW5nID0gZnVuY3Rpb24gY2xvc2VMb2FkaW5nKCkgewogIGFjaXR2ZUF4aW9zLS07CgogIGlmIChhY2l0dmVBeGlvcyA8PSAwKSB7CiAgICBjbGVhclRpbWVvdXQodGltZXIpOwogICAgY29udGV4dC4kYnVzLmVtaXQoImNsb3NlTG9hZGluZyIpOwogIH0KfTsgLy9odHRwIHJlcXVlc3Qg5oum5oiq5ZmoCgoKc2VydmljZS5pbnRlcmNlcHRvcnMucmVxdWVzdC51c2UoZnVuY3Rpb24gKGNvbmZpZykgewogIGlmICghY29uZmlnLmRvbk5vdFNob3dMb2FkaW5nKSB7CiAgICBzaG93TG9hZGluZygpOwogIH0KCiAgdmFyIHRva2VuID0gc3RvcmUuZ2V0dGVyc1sndXNlci90b2tlbiddOwogIHZhciB1c2VyID0gc3RvcmUuZ2V0dGVyc1sndXNlci91c2VySW5mbyddOwogIGNvbmZpZy5kYXRhID0gSlNPTi5zdHJpbmdpZnkoY29uZmlnLmRhdGEpOwogIGNvbmZpZy5oZWFkZXJzID0gewogICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICd4LXRva2VuJzogdG9rZW4sCiAgICAneC11c2VyLWlkJzogdXNlci5JRAogIH07CiAgcmV0dXJuIGNvbmZpZzsKfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgY2xvc2VMb2FkaW5nKCk7CgogIF9NZXNzYWdlKHsKICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgIG1lc3NhZ2U6IGVycm9yLAogICAgdHlwZTogJ2Vycm9yJwogIH0pOwoKICByZXR1cm4gZXJyb3I7Cn0pOyAvL2h0dHAgcmVzcG9uc2Ug5oum5oiq5ZmoCgpzZXJ2aWNlLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgY2xvc2VMb2FkaW5nKCk7CgogIGlmIChyZXNwb25zZS5oZWFkZXJzWyJuZXctdG9rZW4iXSkgewogICAgc3RvcmUuY29tbWl0KCd1c2VyL3NldFRva2VuJywgcmVzcG9uc2UuaGVhZGVyc1sibmV3LXRva2VuIl0pOwogIH0KCiAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PSAwKSB7CiAgICB2YXIgX3Jlc3BvbnNlJGRhdGEkZGF0YTsKCiAgICBpZiAoKF9yZXNwb25zZSRkYXRhJGRhdGEgPSByZXNwb25zZS5kYXRhLmRhdGEpICE9PSBudWxsICYmIF9yZXNwb25zZSRkYXRhJGRhdGEgIT09IHZvaWQgMCAmJiBfcmVzcG9uc2UkZGF0YSRkYXRhLm5lZWRJbml0KSB7CiAgICAgIF9NZXNzYWdlKHsKICAgICAgICB0eXBlOiAiaW5mbyIsCiAgICAgICAgbWVzc2FnZTogIuaCqOaYr+esrOS4gOasoeS9v+eUqO+8jOivt+WIneWni+WMliIKICAgICAgfSk7CgogICAgICBzdG9yZS5jb21taXQoInVzZXIvTmVlZEluaXQiKTsKICAgICAgcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICJpbml0IgogICAgICB9KTsKICAgIH0KICB9CgogIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT0gMCB8fCByZXNwb25zZS5oZWFkZXJzLnN1Y2Nlc3MgPT09ICJ0cnVlIikgewogICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7CiAgfSBlbHNlIHsKICAgIF9NZXNzYWdlKHsKICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICBtZXNzYWdlOiByZXNwb25zZS5kYXRhLm1zZyB8fCBkZWNvZGVVUkkocmVzcG9uc2UuaGVhZGVycy5tc2cpLAogICAgICB0eXBlOiByZXNwb25zZS5oZWFkZXJzLm1zZ3R5cGUgfHwgJ2Vycm9yJwogICAgfSk7CgogICAgaWYgKHJlc3BvbnNlLmRhdGEuZGF0YSAmJiByZXNwb25zZS5kYXRhLmRhdGEucmVsb2FkKSB7CiAgICAgIHN0b3JlLmNvbW1pdCgndXNlci9Mb2dpbk91dCcpOwogICAgfQoKICAgIHJldHVybiByZXNwb25zZS5kYXRhLm1zZyA/IHJlc3BvbnNlLmRhdGEgOiByZXNwb25zZTsKICB9Cn0sIGZ1bmN0aW9uIChlcnJvcikgewogIGNsb3NlTG9hZGluZygpOwoKICBfTWVzc2FnZSh7CiAgICBzaG93Q2xvc2U6IHRydWUsCiAgICBtZXNzYWdlOiBlcnJvciwKICAgIHR5cGU6ICdlcnJvcicKICB9KTsKCiAgcmV0dXJuIGVycm9yOwp9KTsKZXhwb3J0IGRlZmF1bHQgc2VydmljZTs="},{"version":3,"sources":["E:/BaiduNetdiskDownload/gin-vue-admin/web/src/utils/request.js"],"names":["axios","store","context","router","service","create","baseURL","process","env","VUE_APP_BASE_API","timeout","acitveAxios","timer","showLoading","clearTimeout","setTimeout","$bus","emit","closeLoading","interceptors","request","use","config","donNotShowLoading","token","getters","user","data","JSON","stringify","headers","ID","error","showClose","message","type","response","commit","code","needInit","push","name","success","msg","decodeURI","msgtype","reload"],"mappings":"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","sourcesContent":["import axios from 'axios'; // 引入axios\r\nimport { Message } from 'element-ui';\r\nimport { store } from '@/store/index'\r\nimport context from '@/main.js'\r\nimport router from '@/router/index'\r\n\r\nconst service = axios.create({\r\n    baseURL: process.env.VUE_APP_BASE_API,\r\n    timeout: 99999\r\n})\r\nlet acitveAxios = 0\r\nlet timer\r\nconst showLoading = () => {\r\n    acitveAxios++\r\n    if (timer) {\r\n        clearTimeout(timer)\r\n    }\r\n    timer = setTimeout(() => {\r\n        if (acitveAxios > 0) {\r\n            context.$bus.emit(\"showLoading\")\r\n        }\r\n    }, 400);\r\n}\r\n\r\nconst closeLoading = () => {\r\n        acitveAxios--\r\n        if (acitveAxios <= 0) {\r\n            clearTimeout(timer)\r\n            context.$bus.emit(\"closeLoading\")\r\n        }\r\n    }\r\n    //http request 拦截器\r\nservice.interceptors.request.use(\r\n    config => {\r\n        if (!config.donNotShowLoading) {\r\n            showLoading()\r\n        }\r\n        const token = store.getters['user/token']\r\n        const user = store.getters['user/userInfo']\r\n        config.data = JSON.stringify(config.data);\r\n        config.headers = {\r\n            'Content-Type': 'application/json',\r\n            'x-token': token,\r\n            'x-user-id': user.ID\r\n        }\r\n        return config;\r\n    },\r\n    error => {\r\n        closeLoading()\r\n        Message({\r\n            showClose: true,\r\n            message: error,\r\n            type: 'error'\r\n        })\r\n        return error;\r\n    }\r\n);\r\n\r\n\r\n//http response 拦截器\r\nservice.interceptors.response.use(\r\n    response => {\r\n        closeLoading()\r\n\r\n        if (response.headers[\"new-token\"]) {\r\n            store.commit('user/setToken', response.headers[\"new-token\"])\r\n        }\r\n        if(response.data.code == 0){\r\n            if(response.data.data?.needInit){\r\n                Message({\r\n                    type:\"info\",\r\n                    message:\"您是第一次使用，请初始化\"\r\n                })\r\n                    store.commit(\"user/NeedInit\")\r\n                    router.push({name:\"init\"})\r\n            }\r\n        }\r\n        if (response.data.code == 0 || response.headers.success === \"true\") {\r\n            return response.data\r\n        } else {\r\n            Message({\r\n                showClose: true,\r\n                message: response.data.msg || decodeURI(response.headers.msg),\r\n                type: response.headers.msgtype||'error',\r\n            })\r\n            if (response.data.data && response.data.data.reload) {\r\n                store.commit('user/LoginOut')\r\n            }\r\n            return response.data.msg ? response.data : response\r\n        }\r\n    },\r\n    error => {\r\n        closeLoading()\r\n        Message({\r\n            showClose: true,\r\n            message: error,\r\n            type: 'error'\r\n        })\r\n        return error\r\n    }\r\n)\r\n\r\nexport default service"]}]}